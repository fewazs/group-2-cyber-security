{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import DeviceSelector from'./DeviceSelector';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function StatsDashboard(){const[stats,setStats]=useState(null);const[alerts,setAlerts]=useState([]);const[device,setDevice]=useState('all');const[showSpotify,setShowSpotify]=useState(false);const[queries,setQueries]=useState([]);const[trafficMode,setTrafficMode]=useState('dns');// 'dns' or 'all'\nconst[allTraffic,setAllTraffic]=useState([]);const[isCapturing,setIsCapturing]=useState(false);const[captureFilename,setCaptureFilename]=useState(\"\");useEffect(()=>{async function fetchStats(){const res=await axios.get('/stats');setStats(res.data);const alertsRes=await axios.get('/alerts');setAlerts(alertsRes.data);if(trafficMode==='dns'){const queriesRes=await axios.get('/api/dns-stats');setQueries(queriesRes.data.queries||[]);}else{const allRes=await axios.get('/api/all-traffic');setAllTraffic(allRes.data||[]);}}fetchStats();const interval=setInterval(fetchStats,5000);return()=>clearInterval(interval);},[device,showSpotify,trafficMode]);const handleCapture=async()=>{const filename=window.prompt(\"Enter filename for new capture:\",\"capture_\".concat(Date.now(),\".json\"));if(!filename)return;setCaptureFilename(filename);await axios.post('/api/capture/start',{filename});setIsCapturing(true);};const handleStop=async()=>{await axios.post('/api/capture/stop');setIsCapturing(false);};const handleSave=async()=>{const filename=window.prompt(\"Enter filename to save as:\",captureFilename||\"capture_\".concat(Date.now(),\".json\"));if(!filename)return;await axios.post('/api/capture/save',{filename});alert(\"Capture saved as \".concat(filename,\"!\"));};const filteredQueries=queries.filter(q=>{if(device!=='all'&&q.src_ip!==device)return false;if(showSpotify&&!q.query.includes('spotify'))return false;return true;});const filteredAllTraffic=allTraffic.filter(pkt=>{if(device!=='all'&&pkt.src_ip!==device)return false;return true;});if(!stats)return/*#__PURE__*/_jsx(\"div\",{children:\"Loading statistics...\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Spotify DNS Traffic Statistics\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'1em'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleCapture,disabled:isCapturing,children:\"Capture\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleStop,disabled:!isCapturing,children:\"Stop\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSave,children:\"Save\"})]}),/*#__PURE__*/_jsx(DeviceSelector,{onSelect:setDevice}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:showSpotify,onChange:e=>setShowSpotify(e.target.checked)}),\"Show only Spotify queries\"]}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Traffic Mode: \"}),/*#__PURE__*/_jsxs(\"select\",{value:trafficMode,onChange:e=>setTrafficMode(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"dns\",children:\"DNS Only\"}),/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"All Traffic\"})]})]}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsxs(\"li\",{children:[\"Real Spotify DNS Requests: \",stats.real_spotify]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"Fake Spotify DNS Tunneling Attempts: \",stats.fake_spotify]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"Alerts: \",stats.alerts]})]}),/*#__PURE__*/_jsx(\"h3\",{children:\"Recent Alerts\"}),/*#__PURE__*/_jsx(\"ul\",{children:alerts.map((alert,idx)=>/*#__PURE__*/_jsx(\"li\",{children:alert},idx))}),trafficMode==='dns'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"DNS Queries\"}),/*#__PURE__*/_jsx(\"ul\",{children:filteredQueries.map((q,idx)=>/*#__PURE__*/_jsxs(\"li\",{children:[q.src_ip,\": \",q.query]},idx))})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"All Network Traffic\"}),/*#__PURE__*/_jsx(\"ul\",{children:filteredAllTraffic.map((pkt,idx)=>/*#__PURE__*/_jsxs(\"li\",{children:[pkt.timestamp,\": \",pkt.src_ip,\" \\u2192 \",pkt.dst_ip,\" [\",pkt.proto,\"] Size: \",pkt.pkt_size]},idx))})]})]});}export default StatsDashboard;","map":{"version":3,"names":["React","useState","useEffect","axios","DeviceSelector","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","StatsDashboard","stats","setStats","alerts","setAlerts","device","setDevice","showSpotify","setShowSpotify","queries","setQueries","trafficMode","setTrafficMode","allTraffic","setAllTraffic","isCapturing","setIsCapturing","captureFilename","setCaptureFilename","fetchStats","res","get","data","alertsRes","queriesRes","allRes","interval","setInterval","clearInterval","handleCapture","filename","window","prompt","concat","Date","now","post","handleStop","handleSave","alert","filteredQueries","filter","q","src_ip","query","includes","filteredAllTraffic","pkt","children","className","style","marginBottom","onClick","disabled","onSelect","type","checked","onChange","e","target","value","real_spotify","fake_spotify","map","idx","timestamp","dst_ip","proto","pkt_size"],"sources":["/home/noname/Desktop/dns tunneling prevention v2/group-2-cyber-security/dashboard/react-frontend/src/StatsDashboard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport DeviceSelector from './DeviceSelector';\n\nfunction StatsDashboard() {\n  const [stats, setStats] = useState(null);\n  const [alerts, setAlerts] = useState([]);\n  const [device, setDevice] = useState('all');\n  const [showSpotify, setShowSpotify] = useState(false);\n  const [queries, setQueries] = useState([]);\n  const [trafficMode, setTrafficMode] = useState('dns'); // 'dns' or 'all'\n  const [allTraffic, setAllTraffic] = useState([]);\n  const [isCapturing, setIsCapturing] = useState(false);\n  const [captureFilename, setCaptureFilename] = useState(\"\");\n\n  useEffect(() => {\n    async function fetchStats() {\n      const res = await axios.get('/stats');\n      setStats(res.data);\n      const alertsRes = await axios.get('/alerts');\n      setAlerts(alertsRes.data);\n      if (trafficMode === 'dns') {\n        const queriesRes = await axios.get('/api/dns-stats');\n        setQueries(queriesRes.data.queries || []);\n      } else {\n        const allRes = await axios.get('/api/all-traffic');\n        setAllTraffic(allRes.data || []);\n      }\n    }\n    fetchStats();\n    const interval = setInterval(fetchStats, 5000);\n    return () => clearInterval(interval);\n  }, [device, showSpotify, trafficMode]);\n\n  const handleCapture = async () => {\n    const filename = window.prompt(\"Enter filename for new capture:\", `capture_${Date.now()}.json`);\n    if (!filename) return;\n    setCaptureFilename(filename);\n    await axios.post('/api/capture/start', { filename });\n    setIsCapturing(true);\n  };\n  const handleStop = async () => {\n    await axios.post('/api/capture/stop');\n    setIsCapturing(false);\n  };\n  const handleSave = async () => {\n    const filename = window.prompt(\"Enter filename to save as:\", captureFilename || `capture_${Date.now()}.json`);\n    if (!filename) return;\n    await axios.post('/api/capture/save', { filename });\n    alert(`Capture saved as ${filename}!`);\n  };\n\n  const filteredQueries = queries.filter(q => {\n    if (device !== 'all' && q.src_ip !== device) return false;\n    if (showSpotify && !q.query.includes('spotify')) return false;\n    return true;\n  });\n\n  const filteredAllTraffic = allTraffic.filter(pkt => {\n    if (device !== 'all' && pkt.src_ip !== device) return false;\n    return true;\n  });\n\n  if (!stats) return <div>Loading statistics...</div>;\n\n  return (\n    <div className=\"dashboard-container\">\n      <h2>Spotify DNS Traffic Statistics</h2>\n      <div style={{ marginBottom: '1em' }}>\n        <button onClick={handleCapture} disabled={isCapturing}>Capture</button>\n        <button onClick={handleStop} disabled={!isCapturing}>Stop</button>\n        <button onClick={handleSave}>Save</button>\n      </div>\n      <DeviceSelector onSelect={setDevice} />\n      <label>\n        <input type=\"checkbox\" checked={showSpotify} onChange={e => setShowSpotify(e.target.checked)} />\n        Show only Spotify queries\n      </label>\n      <label>\n        <span>Traffic Mode: </span>\n        <select value={trafficMode} onChange={e => setTrafficMode(e.target.value)}>\n          <option value=\"dns\">DNS Only</option>\n          <option value=\"all\">All Traffic</option>\n        </select>\n      </label>\n      <ul>\n        <li>Real Spotify DNS Requests: {stats.real_spotify}</li>\n        <li>Fake Spotify DNS Tunneling Attempts: {stats.fake_spotify}</li>\n        <li>Alerts: {stats.alerts}</li>\n      </ul>\n      <h3>Recent Alerts</h3>\n      <ul>\n        {alerts.map((alert, idx) => (\n          <li key={idx}>{alert}</li>\n        ))}\n      </ul>\n      {trafficMode === 'dns' ? (\n        <>\n          <h3>DNS Queries</h3>\n          <ul>\n            {filteredQueries.map((q, idx) => (\n              <li key={idx}>{q.src_ip}: {q.query}</li>\n            ))}\n          </ul>\n        </>\n      ) : (\n        <>\n          <h3>All Network Traffic</h3>\n          <ul>\n            {filteredAllTraffic.map((pkt, idx) => (\n              <li key={idx}>{pkt.timestamp}: {pkt.src_ip} â†’ {pkt.dst_ip} [{pkt.proto}] Size: {pkt.pkt_size}</li>\n            ))}\n          </ul>\n        </>\n      )}\n    </div>\n  );\n}\n\nexport default StatsDashboard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}